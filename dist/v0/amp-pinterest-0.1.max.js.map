{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","build/all/v0/amp-pinterest-0.1.max.js","build/all/v0/follow-button.js","build/all/v0/pin-widget.js","build/all/v0/pinit-button.js","build/all/v0/util.js","src/asserts.js","src/layout.js","src/service.js","src/url.js","src/xhr.js"],"names":[],"mappings":"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","file":"amp-pinterest-0.1.max.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Copyright 2015 The AMP HTML Authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @fileoverview Shows a Pinterest widget.\n * Examples:\n * <code>\n *\n * <amp-pinterest height=20 width=40\n *   data-do=\"buttonPin\"\n *   data-url=\"http://www.flickr.com/photos/kentbrew/6851755809/\"\n *   data-media=\"http://farm8.staticflickr.com/7027/6851755809_df5b2051c9_z.jpg\"\n *   data-description=\"Next stop: Pinterest\">\n * </amp-pinterest>\n *\n * <amp-pinterest width=245 height=330\n *   data-do=\"embedPin\"\n *   data-url=\"https://www.pinterest.com/pin/99360735500167749/\">\n * </amp-pinterest>\n *\n * </code>\n */\n\nimport {isLayoutSizeDefined} from '../../../src/layout';\n\nimport {FollowButton} from './follow-button';\nimport {PinItButton} from './pinit-button';\nimport {PinWidget} from './pin-widget';\n\n/**\n * AMP Pinterest\n * @attr data-do\n *    - buttonPin: Pin It button\n *    - buttonFollow: User follow button\n */\nclass AmpPinterest extends AMP.BaseElement {\n\n  /** @override */\n  preconnectCallback(onLayout) {\n    // preconnect to widget APIpinMedia\n    this.preconnect.url('https://widgets.pinterest.com', onLayout);\n  }\n\n  /** @override */\n  isLayoutSupported(layout) {\n    return isLayoutSizeDefined(layout);\n  }\n\n  /** @override */\n  layoutCallback() {\n    const selector = AMP.assert(this.element.getAttribute('data-do'),\n      'The data-do attribute is required for <amp-pinterest> %s',\n      this.element);\n\n    return this.render(selector).then(node => {\n      return this.element.appendChild(node);\n    });\n  }\n\n  render(selector) {\n    switch (selector) {\n      case 'embedPin':\n        return new PinWidget(this.element).render();\n      case 'buttonPin':\n        return new PinItButton(this.element).render();\n      case 'buttonFollow':\n        return new FollowButton(this.element).render();\n    }\n    return Promise.resolve('Invalid selector: ', selector);\n  }\n\n};\n\nAMP.registerElement('amp-pinterest', AmpPinterest, \".-amp-pinterest-round{height:16px;width:16px;background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_round_red_16_2.png);background-size:16px 16px}.-amp-pinterest-round-tall{height:32px;width:32px;background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_round_red_32_2.png);background-size:32px 32px}.-amp-pinterest-rect{height:20px;width:40px;background:url() 0 -20px no-repeat;background-size:40px 60px}.-amp-pinterest-rect:hover{background-position:0 0}.-amp-pinterest-rect:active{background-position:0 -40px}.-amp-pinterest-en-gray{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_rect_gray_20_2.png)}.-amp-pinterest-en-red{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_rect_red_20_2.png)}.-amp-pinterest-en-white{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_rect_white_20_2.png)}.-amp-pinterest-ja-gray{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_ja_rect_gray_20_2.png)}.-amp-pinterest-ja-red{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_ja_rect_red_20_2.png)}.-amp-pinterest-ja-white{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_ja_rect_white_20_2.png)}.-amp-pinterest-rect-tall{height:28px;width:56px;background:url() 0 -28px no-repeat;background-size:56px 84px}.-amp-pinterest-rect-tall:hover{background-position:0 0}.-amp-pinterest-rect-tall:active{background-position:0 -56px}.-amp-pinterest-en-gray-tall{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_rect_gray_28_2.png)}.-amp-pinterest-en-red-tall{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_rect_red_28_2.png)}.-amp-pinterest-en-white-tall{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_en_rect_white_28_2.png)}.-amp-pinterest-ja-gray-tall{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_ja_rect_gray_28_2.png)}.-amp-pinterest-ja-red-tall{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_ja_rect_red_28_2.png)}.-amp-pinterest-ja-white-tall{background-image:url(https://s-passets.pinimg.com/images/pidgets/pinit_bg_ja_rect_white_28_2.png)}.-amp-pinterest-count-pad-above{margin-top:30px}.-amp-pinterest-count-pad-above-tall{margin-top:38px}.-amp-pinterest-bubble-above{bottom:21px;height:29px;width:40px;background:transparent url(https://s-passets.pinimg.com/images/pidgets/count_north_white_rect_20_2.png) 0 0 no-repeat;background-size:40px 29px;font:12px Arial,Helvetica,sans-serif;line-height:24px}.-amp-pinterest-bubble-above,.-amp-pinterest-bubble-above-tall{position:absolute;left:0;text-align:center;text-decoration:none;color:#777}.-amp-pinterest-bubble-above-tall{bottom:29px;height:37px;width:56px;background:transparent url(https://s-passets.pinimg.com/images/pidgets/count_north_white_rect_28_2.png) 0 0 no-repeat;background-size:56px 37px;font:15px Arial,Helvetica,sans-serif;line-height:28px}.-amp-pinterest-count-pad-beside{width:86px}.-amp-pinterest-count-pad-beside-tall{width:120px}.-amp-pinterest-bubble-beside{height:20px;width:45px;text-indent:5px;background:transparent url(https://s-passets.pinimg.com/images/pidgets/count_east_white_rect_20_2.png) 0 0 no-repeat;background-size:45px 20px;font:12px Arial,Helvetica,sans-serif;line-height:20px}.-amp-pinterest-bubble-beside,.-amp-pinterest-bubble-beside-tall{position:absolute;top:0;right:0;text-align:center;text-decoration:none;color:#777}.-amp-pinterest-bubble-beside-tall{height:28px;width:63px;text-indent:7px;background:transparent url(https://s-passets.pinimg.com/images/pidgets/count_east_white_rect_28_2.png) 0 0 no-repeat;background-size:63px 28px;font:15px Arial,Helvetica,sans-serif;line-height:28px}.-amp-pinterest-follow-button{background:transparent url(https://s-passets.pinimg.com/images/pidgets/bfs2.png) 0 0 no-repeat;background-size:200px 60px;border-right:1px solid #d0d0d0;border-radius:4px;color:#444;cursor:pointer;display:inline-block;font:700 normal normal 11px/20px Helvetica Neue,helvetica,arial,san-serif;padding-right:3px;position:relative;text-decoration:none;text-indent:20px}.-amp-pinterest-follow-button:hover{background-position:0 -20px;border-right-color:#919191}.-amp-pinterest-follow-button i{background-image:url(https://s-passets.pinimg.com/images/pidgets/log2.png);background-size:14px 14px;height:14px;left:3px;position:absolute;top:3px;width:14px}.-amp-pinterest-embed-pin,.-amp-pinterest-embed-pin-medium{padding:5px;width:237px}.-amp-pinterest-embed-pin-medium{width:345px}.-amp-pinterest-embed-pin-inner{display:block;position:relative;-webkit-font-smoothing:antialiased;cursor:pointer;background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.33);border-radius:3px;width:100%}.-amp-pinterest-embed-pin-text{color:#a8a8a8;white-space:normal;font-family:Helvetica Neue,arial,sans-serif;font-size:11px;line-height:18px;font-weight:700}.-amp-pinterest-embed-pin-image{border-radius:3px 3px 0 0}.-amp-pinterest-embed-pin-text-block{display:block;line-height:30px;padding:0 12px}.-amp-pinterest-embed-pin-text-icon-attrib{height:16px;width:16px;vertical-align:middle}.-amp-pinterest-embed-pin-stats{height:16px;line-height:16px;padding:8px 12px}.-amp-pinterest-embed-pin-stats-likes{padding-left:14px;background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAAAAAClR+AmAAAAUElEQVR4AT2HMQpFIQwEc/+zbXhFLBW8QUihIAT2E8Q/xe6M0Jv2zK7NKUcBzAlAjzjqtdZl4c8S2nOjMPS6BoWMr/wLVnAbYJs3mGMkXzx+OeRqUf5HHRoAAAAASUVORK5CYII=) 0 2px no-repeat}.-amp-pinterest-embed-pin-stats-repins{padding:0 10px 0 18px;background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAALCAAAAABq7uO+AAAASklEQVQI10WNMQrAMBRCvf/Z3pQcImPplsIPdqhNXOSJqLxVtnWQsuUO9IM3cHlV8dSSDZQHAOPH2YA2FU+qtH7MRhaVh/xt/PQCEW6N4EV+CPEAAAAASUVORK5CYII=) 0 0 no-repeat}.-amp-pinterest-embed-pin-description{color:#363636;font-weight:400;font-size:14px;line-height:17px;padding-top:5px}.-amp-pinterest-embed-pin-pinner{padding:12px;border-top:1px solid rgba(0,0,0,.09)}.-amp-pinterest-embed-pin-pinner-avatar{border-radius:15px;border:none;height:30px;width:30px;vertical-align:middle;margin:0 8px 12px 0;float:left}.-amp-pinterest-embed-pin-board-name,.-amp-pinterest-embed-pin-pinner-name{display:block;height:15px;line-height:15px}.-amp-pinterest-embed-pin-pinner-name{color:#777}.-amp-pinterest-embed-pin-repin{position:absolute;top:12px;left:12px;cursor:pointer}\\n/*# sourceURL=/extensions/amp-pinterest/0.1/amp-pinterest.css*/\");\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assertHttpsUrl} from '../../../src/url';\n\nimport {Util} from './util';\n\n// Popup options\nconst POP_FOLLOW = `status=no,resizable=yes,scrollbars=yes,\n  personalbar=no,directories=no,location=no,toolbar=no,\n  menubar=no,width=1040,height=640,left=0,top=0`;\n\n/**\n * Pinterest Follow Button\n * @attr data-href:  the url of the user's profile to follow\n * @attr data-label: the text to display (user's full name)\n */\nexport class FollowButton {\n\n  /** @param {!Element} rootElement */\n  constructor(rootElement) {\n    AMP.assert(rootElement.getAttribute('data-href'),\n      'The data-href attribute is required for follow buttons');\n    AMP.assert(rootElement.getAttribute('data-label'),\n      'The data-label attribute is required for follow buttons');\n    this.element = rootElement;\n    this.label = rootElement.getAttribute('data-label');\n    this.href = assertHttpsUrl(rootElement.getAttribute('data-href'));\n  }\n\n  /**\n   * Override the default href click handling to log and open popup\n   * @param {Event} event: the HTML event object\n   */\n  handleClick(event) {\n    event.preventDefault();\n    window.open(this.href, 'pin' + new Date().getTime(), POP_FOLLOW);\n    Util.log(`&type=button_follow&href=${this.href}`);\n  }\n\n  /**\n   * Render the follow button\n   * @returns {Element}\n   */\n  renderTemplate() {\n    const followButton = Util.make({'a': {\n      class: '-amp-pinterest-follow-button',\n      href: this.href,\n      textContent: this.label\n    }});\n    followButton.appendChild(Util.make({'i': {}}));\n    followButton.onclick = this.handleClick.bind(this);\n    return followButton;\n  }\n\n  /**\n   * Prepare the render data, create the node and add handlers\n   * @returns {!Promise}\n   */\n  render() {\n    // Add trailing slash?\n    if (this.href.substr(-1) !== '/') {\n      this.href += '/';\n    }\n    this.href += `pins/follow/?guid=${Util.guid}`;\n\n    return Promise.resolve(this.renderTemplate());\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assertHttpsUrl} from '../../../src/url';\nimport {xhrFor} from '../../../src/xhr';\n\nimport {Util} from './util';\n\n// Popup options\nconst POP = 'status=no,resizable=yes,scrollbars=yes,' +\n  'personalbar=no,directories=no,location=no,toolbar=no,' +\n  'menubar=no,width=900,height=500,left=0,top=0';\n\n/**\n * Pinterest Pin Widget\n * @attr data-url: the source url for the Pin\n */\nexport class PinWidget {\n\n  /** @param {!Element} rootElement */\n  constructor(rootElement) {\n    AMP.assert(rootElement.getAttribute('data-url'),\n      'The data-url attribute is required for Pin widgets');\n    this.element = rootElement;\n    this.xhr = xhrFor(rootElement.ownerDocument.defaultView);\n  }\n\n  /**\n   * Override the default href click handling to log and open popup\n   * @param {Event} event: the HTML event object\n   */\n  handleClick(event) {\n    event.preventDefault();\n    const el = event.target;\n    const shouldPop = el.getAttribute('data-pin-pop') || false;\n    const href = el.getAttribute('data-pin-href');\n    const log = el.getAttribute('data-pin-log');\n    if (href) {\n      if (shouldPop) {\n        window.open(href, '_pinit', POP);\n      } else {\n        window.open(`${href}?amp=1&guid=${Util.guid}`, '_blank');\n      }\n    }\n    if (log) {\n      Util.log('&type=' + log);\n    }\n  }\n\n  fetchPin() {\n    const baseUrl = 'https://widgets.pinterest.com/v3/pidgets/pins/info/?';\n    const query = `pin_ids=${this.pinId}&sub=www&base_scheme=https`;\n    return this.xhr.fetchJson(baseUrl + query)\n      .then(response => {\n        try {\n          return response.data[0];\n        } catch (e) { return null; }\n      });\n  }\n\n  renderPin(pin) {\n    // start setting our class name\n    let className = '-amp-pinterest-embed-pin';\n    let imgUrl = assertHttpsUrl(pin.images['237x'].url);\n\n    // large widgets may come later\n    if (this.width === 'medium' || this.width === 'large') {\n      className = className + '-medium';\n      imgUrl = imgUrl.replace(/237/, '345');\n      Util.log('&type=pidget&pin_count_medium=1');\n    } else {\n      Util.log('&type=pidget&pin_count=1');\n    }\n\n    const structure = Util.make({'span': {}});\n    structure.className = className + ' -amp-fill-content';\n\n    const container = Util.make({'span': {\n      'className': '-amp-pinterest-embed-pin-inner',\n      'data-pin-log': 'embed_pin'\n    }});\n\n    const img = Util.make({'img': {\n      'src': imgUrl,\n      'className': '-amp-pinterest-embed-pin-image',\n      'data-pin-no-hover': true,\n      'data-pin-href': 'https://www.pinterest.com/pin/' + pin.id + '/',\n      'data-pin-log': 'embed_pin_img'\n    }});\n    container.appendChild(img);\n\n    // repin button\n    const repin = Util.make({'span': {\n      'className': '-amp-pinterest-rect -amp-pinterest-en-red' +\n        ' -amp-pinterest-embed-pin-repin',\n      'data-pin-log': 'embed_pin_repin',\n      'data-pin-pop': '1',\n      'data-pin-href': 'https://www.pinterest.com/pin/' + pin.id +\n        '/repin/x/?amp=1&guid=' + Util.guid\n    }});\n    container.appendChild(repin);\n\n    // text container\n    const text = Util.make({'span': {\n      'className': '-amp-pinterest-embed-pin-text'\n    }});\n\n    // description\n    if (pin.description) {\n      const description = Util.make({'span': {\n        'className': '-amp-pinterest-embed-pin-text-block ' +\n          '-amp-pinterest-embed-pin-description',\n        'textContent': Util.filter(pin.description)\n      }});\n      text.appendChild(description);\n    }\n\n    // attribution\n    if (pin.attribution) {\n      const attribution = Util.make({'span': {\n        'className': '-amp-pinterest-embed-pin-text-block' +\n          ' -amp-pinterest-embed-pin-attribution'\n      }});\n      attribution.appendChild(Util.make({'img': {\n        'className': '-amp-pinterest-embed-pin-text-icon-attrib',\n        'src': pin.attribution.provider_icon_url\n      }}));\n      attribution.appendChild(Util.make({'span': {\n        'textContent': ' by '\n      }}));\n      attribution.appendChild(Util.make({'span': {\n        'data-pin-href': pin.attribution.url,\n        'textContent': Util.filter(pin.attribution.author_name)\n      }}));\n      text.appendChild(attribution);\n    }\n\n    // likes and repins\n    if (pin.repin_count || pin.like_count) {\n      const stats = Util.make({'span': {\n        'className': '-amp-pinterest-embed-pin-text-block' +\n          ' -amp-pinterest-embed-pin-stats'\n      }});\n      if (pin.repin_count) {\n        const repinCount = Util.make({'span': {\n          'className': '-amp-pinterest-embed-pin-stats-repins',\n          'textContent': String(pin.repin_count)\n        }});\n        stats.appendChild(repinCount);\n      }\n\n      if (pin.like_count) {\n        const likeCount = Util.make({'span': {\n          'className': '-amp-pinterest-embed-pin-stats-likes',\n          'textContent': String(pin.like_count)\n        }});\n        stats.appendChild(likeCount);\n      }\n      text.appendChild(stats);\n    }\n\n    // pinner\n    if (pin.pinner) {\n\n      const pinner = Util.make({'span': {\n        'className': '-amp-pinterest-embed-pin-text-block' +\n          ' -amp-pinterest-embed-pin-pinner'\n      }});\n\n      // avatar\n      pinner.appendChild(Util.make({'img': {\n        'className': '-amp-pinterest-embed-pin-pinner-avatar',\n        'alt': Util.filter(pin.pinner.full_name),\n        'title': Util.filter(pin.pinner.full_name),\n        'src': pin.pinner.image_small_url,\n        'data-pin-href': pin.pinner.profile_url\n      }}));\n\n      // name\n      pinner.appendChild(Util.make({'span': {\n        'className': '-amp-pinterest-embed-pin-pinner-name',\n        'textContent': Util.filter(pin.pinner.full_name),\n        'data-pin-href': pin.pinner.profile_url\n      }}));\n\n      // board\n      pinner.appendChild(Util.make({'span': {\n        'className': '-amp-pinterest-embed-pin-board-name',\n        'textContent': Util.filter(pin.board.name),\n        'data-pin-href': 'https://www.pinterest.com/' + pin.board.url\n      }}));\n\n      text.appendChild(pinner);\n    }\n\n    container.appendChild(text);\n    structure.appendChild(container);\n\n    // listen for clicks\n    structure.addEventListener('click', this.handleClick.bind(this));\n\n    // done\n    return structure;\n  }\n\n  render() {\n    this.pinUrl = this.element.getAttribute('data-url');\n    this.width = this.element.getAttribute('data-width');\n\n    this.pinId = '';\n    try {\n      this.pinId = this.pinUrl.split('/pin/')[1].split('/')[0];\n    } catch (err) { return; }\n\n    return this.fetchPin()\n      .then(this.renderPin.bind(this));\n  }\n\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {xhrFor} from '../../../src/xhr';\n\nimport {Util} from './util';\n\n// Popup options\nconst POP = 'status=no,resizable=yes,scrollbars=yes,' +\n  'personalbar=no,directories=no,location=no,toolbar=no,' +\n  'menubar=no,width=900,height=500,left=0,top=0';\n\n/**\n * Pinterest Pinit Button\n * @attr data-url: the source url for the Pin\n * @attr data-media: the url of the Pin image/media\n * @attr data-description: the description of the Pin\n *\n * OPTIONAL\n * @attr data-color: the button color from [red, white, gray]\n * @attr data-count: the position of the Pin count from [beside, above]\n * @attr data-lang:  the language of the button from [en, ja]\n * @attr data-round: should the button be round (true if set)\n * @attr data-tall:  should the button be tall  (true if set)\n */\nexport class PinItButton {\n\n  /** @param {!Element} rootElement */\n  constructor(rootElement) {\n    AMP.assert(rootElement.getAttribute('data-url'),\n      'The data-url attribute is required for Pin It buttons');\n    AMP.assert(rootElement.getAttribute('data-media'),\n      'The data-media attribute is required for Pin It buttons');\n    AMP.assert(rootElement.getAttribute('data-description'),\n      'The data-description attribute is required for Pin It buttons');\n    this.element = rootElement;\n    this.xhr = xhrFor(rootElement.ownerDocument.defaultView);\n    this.color = rootElement.getAttribute('data-color');\n    this.count = rootElement.getAttribute('data-count');\n    this.lang = rootElement.getAttribute('data-lang');\n    this.round = rootElement.getAttribute('data-round');\n    this.tall = rootElement.getAttribute('data-tall');\n    this.description = rootElement.getAttribute('data-description');\n  }\n\n  /**\n   * Override the default href click handling to log and open popup\n   * @param {Event} event: the HTML event object\n   */\n  handleClick(event) {\n    event.preventDefault();\n    window.open(this.href, '_pinit', POP);\n    Util.log('&type=button_pinit');\n  }\n\n  /**\n   * Fetch the remote Pin count for the source URL\n   * @param {Event} evt: the HTML event object\n   * @returns {Promise}\n   */\n  fetchCount() {\n    const url = `https://widgets.pinterest.com/v1/urls/count.json?return_jsonp=false&url=${this.url}`;\n    return this.xhr.fetchJson(url);\n  }\n\n  /**\n   * Pretty print the Pin count with english suffixes\n   * @param {number} count: the Pin count for the source URL\n   * @returns {string}\n   */\n  formatPinCount(count) {\n    if (count > 999) {\n      if (count < 1000000) {\n        count = parseInt(count / 1000, 10) + 'K+';\n      } else {\n        if (count < 1000000000) {\n          count = parseInt(count / 1000000, 10) + 'M+';\n        } else {\n          count = '++';\n        }\n      }\n    }\n    return count;\n  }\n\n  /**\n   * Render helper for the optional count bubble\n   * @param {string} count: the data-count attribute\n   * @param {string} heightClass: the height class to apply for spacing\n   * @returns {string}\n   */\n  renderCount(count, heightClass) {\n    Util.log('&type=pidget&button_count=1');\n    return Util.make({'span': {\n      class: `-amp-pinterest-bubble-${this.count}${heightClass}`,\n      textContent: this.formatPinCount(count)\n    }});\n  }\n\n  /**\n   * Render the follow button\n   * @param {number} count: optional Pin count for the source URL\n   * @returns {Element}\n   */\n  renderTemplate(count) {\n    const CLASS = {\n      shape: this.round ? '-round' : '-rect',\n      height: this.tall ? '-tall' : '',\n      lang: this.lang === 'ja' ? '-ja' : '-en',\n      color: ['red', 'white'].indexOf(this.color) !== -1 ? this.color : 'gray'\n    };\n\n    const clazz = [\n      `-amp-pinterest${CLASS.shape}${CLASS.height}`,\n      '-amp-fill-content'\n    ];\n\n    let countBubble = '';\n    if (!this.round) {\n      clazz.push(`-amp-pinterest${CLASS.lang}-${CLASS.color}${CLASS.height}`);\n      if (count) {\n        clazz.push(`-amp-pinterest-count-pad-${this.count}${CLASS.height}`);\n        countBubble = this.renderCount(count.count, CLASS.height);\n      }\n    }\n\n    const pinitButton = Util.make({'a': {\n      class: clazz.join(' '),\n      href: this.href\n    }});\n\n    if (countBubble) {\n      pinitButton.appendChild(countBubble);\n    }\n    pinitButton.onclick = this.handleClick.bind(this);\n    return pinitButton;\n  }\n\n  /**\n   * Prepare the render data, create the node and add handlers\n   * @returns {!Promise}\n   */\n  render() {\n    this.description = encodeURIComponent(this.description);\n    this.media = encodeURIComponent(this.element.getAttribute('data-media'));\n    this.url = encodeURIComponent(this.element.getAttribute('data-url'));\n\n    const query = [\n      `amp=1`,\n      `guid=${Util.guid}`,\n      `url=${this.url}`,\n      `media=${this.media}`,\n      `description=${this.description}`\n    ].join('&');\n    this.href = `https://www.pinterest.com/pin/create/button/?${query}`;\n\n    let promise;\n    if (this.count === 'above' || this.count === 'beside') {\n      promise = this.fetchCount();\n    } else {\n      promise = Promise.resolve();\n    }\n    return promise.then(this.renderTemplate.bind(this));\n  }\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// characters to be used in the creation of guids\nconst BASE60 = '0123456789ABCDEFGHJKLMNPQRSTUVWXYZ_abcdefghijkmnopqrstuvwxyz';\n\n// make a 12-digit base-60 number for performance tracking\nlet guid = '';\nfor (let i = 0; i < 12; i = i + 1) {\n  guid = guid + BASE60.substr(Math.floor(Math.random() * 60), 1);\n}\n\n/**\n * Prepare the render data, create the node and add handlers\n * @param {string} queryParams - optional query string to append\n */\nfunction log(queryParams) {\n  const call = new Image();\n  let query = 'https://log.pinterest.com/?guid=' + guid;\n  query = query + '&amp=1';\n  if (queryParams) {\n    query = query + queryParams;\n  }\n  query = query + '&via=' + encodeURIComponent(window.location.href);\n  call.src = query;\n};\n\n/**\n * Strip data from string\n * @param {string} str - the string to filter\n * @returns {string}\n */\nfunction filter(str) {\n  let decoded, ret;\n  decoded = '';\n  ret = '';\n  try {\n    decoded = decodeURIComponent(str);\n  } catch (e) { }\n  ret = decoded.replace(/</g, '&lt;');\n  ret = ret.replace(/>/g, '&gt;');\n  return ret;\n};\n\n/**\n * Create a DOM element with attributes\n * @param {Object} data - the string to filter\n * @returns {DOMElement}\n */\nfunction make(data) {\n  let el = false, tag, attr;\n  for (tag in data) {\n    el = document.createElement(tag);\n    for (attr in data[tag]) {\n      if (typeof data[tag][attr] === 'string') {\n        set(el, attr, data[tag][attr]);\n      }\n    }\n    break;\n  }\n  return el;\n};\n\n/**\n * Set a DOM element attribute\n * @param {DOMElement} data - the string to filter\n * @param {string} attr - the attribute key\n * @param {string} value - the attribute value\n */\nfunction set(el, attr, value) {\n  if (typeof el[attr] === 'string') {\n    el[attr] = value;\n  } else {\n    el.setAttribute(attr, value);\n  }\n};\n\nexport const Util = {\n  filter: filter,\n  guid: guid,\n  log: log,\n  make: make,\n  set: set\n};\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * Throws an error if the first argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - associatedElement: This is the first element provided in the var args.\n *   It can be used for improved display of error messages.\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n *\n * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n *     not evaluate to true.\n * @param {string} message The assertion message\n * @param {...*} var_args Arguments substituted into %s in the message.\n * @return {T} The value of shouldBeTrueish.\n * @template T\n */\n/*eslint \"google-camelcase/google-camelcase\": 0*/\nexport function assert(shouldBeTrueish, message, var_args) {\n  let firstElement;\n  if (!shouldBeTrueish) {\n    message = message || 'Assertion failed';\n    const splitMessage = message.split('%s');\n    const first = splitMessage.shift();\n    let formatted = first;\n    const messageArray = [];\n    pushIfNonEmpty(messageArray, first);\n    for (let i = 2; i < arguments.length; i++) {\n      const val = arguments[i];\n      if (val && val.tagName) {\n        firstElement = val;\n      }\n      const nextConstant = splitMessage.shift();\n      messageArray.push(val);\n      pushIfNonEmpty(messageArray, nextConstant.trim());\n      formatted += toString(val) + nextConstant;\n    }\n    const e = new Error(formatted);\n    e.fromAssert = true;\n    e.associatedElement = firstElement;\n    e.messageArray = messageArray;\n    throw e;\n  }\n  return shouldBeTrueish;\n}\n/*eslint \"google-camelcase/google-camelcase\": 2*/\n\n/**\n * @param {*} val\n * @return {string}\n */\nfunction toString(val) {\n  if (val instanceof Element) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return val;\n}\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Implements element layout. See https://goo.gl/9avXuT for\n * details.\n */\n\nimport {assert} from './asserts';\n\n\n/**\n * @enum {string}\n */\nexport const Layout = {\n  NODISPLAY: 'nodisplay',\n  FIXED: 'fixed',\n  FIXED_HEIGHT: 'fixed-height',\n  RESPONSIVE: 'responsive',\n  CONTAINER: 'container',\n  FILL: 'fill'\n};\n\n\n/**\n * CSS Length type. E.g. \"1px\" or \"20vh\".\n * @typedef {string}\n */\nlet LengthDef;\n\n\n/**\n * @typedef {{\n *   width: string,\n *   height: string\n * }}\n */\nlet DimensionsDef;\n\n\n/**\n * The set of elements with natural dimensions, that is, elements\n * which have a known dimension either based on their value specified here,\n * or, if the value is null, a dimension specific to the browser.\n * `hasNaturalDimensions` checks for membership in this set.\n * `getNaturalDimensions` determines the dimensions for an element in the\n *    set and caches it.\n * @type {!Object<string, ?DimensionsDef>}\n * @private  Visible for testing only!\n */\nexport const naturalDimensions_ = {\n  'AMP-PIXEL': {width: '1px', height: '1px'},\n  'AMP-ANALYTICS': {width: '1px', height: '1px'},\n  // TODO(dvoytenko): audio should have width:auto.\n  'AMP-AUDIO': null\n};\n\n\n/**\n * Elements that the progess can be shown for. This set has to be externalized\n * since the element's implementation may not be downloaded yet.\n * @enum {boolean}\n * @private  Visible for testing only!\n */\nexport const LOADING_ELEMENTS_ = {\n  'AMP-ANIM': true,\n  'AMP-BRIGHTCOVE': true,\n  'AMP-IFRAME': true,\n  'AMP-IMG': true,\n  'AMP-INSTAGRAM': true,\n  'AMP-LIST': true,\n  'AMP-PINTEREST': true,\n  'AMP-VIDEO': true\n};\n\n\n/**\n * @param {string} s\n * @return {Layout|undefined} Returns undefined in case of failure to parse\n *   the layout string.\n */\nexport function parseLayout(s) {\n  for (const k in Layout) {\n    if (Layout[k] == s) {\n      return Layout[k];\n    }\n  }\n  return undefined;\n}\n\n\n/**\n * @param {!Layout} layout\n * @return {string}\n */\nexport function getLayoutClass(layout) {\n  return '-amp-layout-' + layout;\n}\n\n\n/**\n * Whether an element with this layout inherently defines the size.\n * @param {!Layout} layout\n * @return {boolean}\n */\nexport function isLayoutSizeDefined(layout) {\n  return (layout == Layout.FIXED ||\n      layout == Layout.FIXED_HEIGHT ||\n      layout == Layout.RESPONSIVE ||\n      layout == Layout.FILL);\n}\n\n\n/**\n * Whether the tag is an internal (service) AMP tag.\n * @param {!Node|string} tag\n * @return {boolean}\n */\nexport function isInternalElement(tag) {\n  const tagName = (typeof tag == 'string') ? tag : tag.tagName;\n  return tagName && tagName.toLowerCase().indexOf('i-') == 0;\n}\n\n\n/**\n * Parses the CSS length value. If no units specified, the assumed value is\n * \"px\". Returns undefined in case of parsing error.\n * @param {string|undefined} s\n * @return {!LengthDef|undefined}\n */\nexport function parseLength(s) {\n  if (typeof s == 'number') {\n    return s + 'px';\n  }\n  if (!s) {\n    return undefined;\n  }\n  if (!/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax)?$/.test(s)) {\n    return undefined;\n  }\n  if (/^\\d+(\\.\\d+)?$/.test(s)) {\n    return s + 'px';\n  }\n  return s;\n}\n\n\n/**\n * Asserts that the supplied value is a CSS Length value.\n * @param {!LengthDef|string} length\n * @return {!LengthDef}\n */\nexport function assertLength(length) {\n  assert(/^\\d+(\\.\\d+)?(px|em|rem|vh|vw|vmin|vmax)$/.test(length),\n      'Invalid length value: %s', length);\n  return length;\n}\n\n\n/**\n * Returns units from the CSS length value.\n * @param {!LengthDef} length\n * @return {string}\n */\nexport function getLengthUnits(length) {\n  assertLength(length);\n  const m = assert(length.match(/[a-z]+/i),\n      'Failed to read units from %s', length);\n  return m[0];\n}\n\n\n/**\n * Returns the numeric value of a CSS length value.\n * @param {!LengthDef|string} length\n * @return {number}\n */\nexport function getLengthNumeral(length) {\n  return parseFloat(length);\n}\n\n\n/**\n * Determines whether the tagName is a known element that has natural dimensions\n * in our runtime or the browser.\n * @param {string} tagName The element tag name.\n * @return {DimensionsDef}\n */\nexport function hasNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  return naturalDimensions_[tagName] !== undefined;\n}\n\n\n/**\n * Determines the default dimensions for an element which could vary across\n * different browser implementations, like <audio> for instance.\n * This operation can only be completed for an element whitelisted by\n * `hasNaturalDimensions`.\n * @param {string} tagName The element tag name.\n * @return {DimensionsDef}\n */\nexport function getNaturalDimensions(tagName) {\n  tagName = tagName.toUpperCase();\n  assert(naturalDimensions_[tagName] !== undefined);\n  if (!naturalDimensions_[tagName]) {\n    const naturalTagName = tagName.replace(/^AMP\\-/, '');\n    const temp = document.createElement(naturalTagName);\n    // For audio, should no-op elsewhere.\n    temp.controls = true;\n    temp.style.position = 'absolute';\n    temp.style.visibility = 'hidden';\n    document.body.appendChild(temp);\n    naturalDimensions_[tagName] = {\n      width: (temp./*OK*/offsetWidth || 1) + 'px',\n      height: (temp./*OK*/offsetHeight || 1) + 'px'\n    };\n    document.body.removeChild(temp);\n  }\n  return naturalDimensions_[tagName];\n}\n\n\n/**\n * Whether the loading can be shown for the specified elemeent. This set has\n * to be externalized since the element's implementation may not be\n * downloaded yet.\n * @param {string} tagName The element tag name.\n * @return {boolean}\n */\nexport function isLoadingAllowed(tagName) {\n  return LOADING_ELEMENTS_[tagName.toUpperCase()] || false;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assert} from './asserts';\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise|undefined),\n *   resolve: (?function(!Object)|undefined),\n * }}\n */\nlet ServiceHolderDef;\n\n/**\n * Returns a service for the given id and window (a per-window singleton).\n * If the service is not yet available the factory function is invoked and\n * expected to return the service.\n * Users should typically wrap this as a special purpose function (e.g.\n * viewportFor(win)) for type safety and because the factory should not be\n * passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(!Window):!Object=} opt_factory Should create the service\n *     if it does not exist yet. If the factory is not given, it is an error\n *     if the service does not exist yet.\n * @return {*}\n */\nexport function getService(win, id, opt_factory) {\n  const services = getServices(win);\n  let s = services[id];\n  if (!s) {\n    s = services[id] = {};\n  }\n  if (!s.obj) {\n    assert(opt_factory, 'Factory not given and service missing %s', id);\n    s.obj = opt_factory(win);\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * Returns a promise for a service for the given id and window. Also expects\n * an element that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * Users should typically wrap this as a special purpose function (e.g.\n * viewportFor(win)) for type safety and because the factory should not be\n * passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} provideByElement Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, providedByElement) {\n  // Call `getElementService_` in a micro-task to ensure that `stubElements`\n  // has been called.\n  return Promise.resolve().then(() => {\n    return getElementService_(win, id, providedByElement);\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} provideByElement Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<*>}\n * @private\n */\nfunction getElementService_(win, id, providedByElement) {\n  assert(isElementScheduled(win, providedByElement),\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, providedByElement, providedByElement, providedByElement);\n  const services = getServices(win);\n  const s = services[id];\n  if (s) {\n    // If a service was registered with getService, we make a promise from it\n    // which we will return in future invocations.\n    if (!s.promise) {\n      s.promise = Promise.resolve(s.obj);\n    }\n    return s.promise;\n  }\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  let resolve;\n  const p = new Promise(r => {\n    resolve = r;\n  });\n  services[id] = {\n    obj: null,\n    promise: p,\n    resolve: resolve,\n  };\n\n  return p;\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  assert(win.ampExtendedElements, 'win.ampExtendedElements not created yet');\n  return !!win.ampExtendedElements[elementName];\n}\n\n/**\n * In order to provide better error messages we only allow to retrieve\n * services from other elements if those elements are loaded in the page.\n * This makes it possible to mark an element as loaded in a test.\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n */\nexport function markElementScheduledForTesting(win, elementName) {\n  if (!win.ampExtendedElements) {\n    win.ampExtendedElements = {};\n  }\n  win.ampExtendedElements[elementName] = true;\n}\n\n/**\n * Returns the object that holds the services registered in a window.\n * @param {!Window} win\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(win) {\n  let services = win.services;\n  if (!services) {\n    services = win.services = {};\n  }\n  return services;\n}\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Window} win\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(win, id) {\n  if (win.services) {\n    win.services[id] = null;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assert} from './asserts';\n\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * @param {string} url\n * @return {!Location}\n */\nexport function parseUrl(url) {\n  const a = document.createElement('a');\n  a.href = url;\n  const info = {\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash\n  };\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  info.origin = (a.origin && a.origin != 'null') ? a.origin : getOrigin(info);\n  assert(info.origin, 'Origin must exist');\n  return info;\n}\n\n\n/**\n * Asserts that a given url is HTTPS or protocol relative.\n * Provides an exception for localhost.\n * @param {string} urlString\n * @param {!Element} elementContext Element where the url was found.\n * @return {string}\n */\nexport function assertHttpsUrl(urlString, elementContext) {\n  const url = parseUrl(urlString);\n  assert(\n      url.protocol == 'https:' || /^(\\/\\/)/.test(urlString) ||\n      url.hostname == 'localhost' ||\n          url.hostname.lastIndexOf('.localhost') ==\n          // Poor person's endsWith\n          url.hostname.length - '.localhost'.length,\n      '%s source must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n      elementContext, urlString);\n  return urlString;\n}\n\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n * @param {string} queryString\n * @return {!Object<string, string>}\n */\nexport function parseQueryString(queryString) {\n  const params = Object.create(null);\n  if (!queryString) {\n    return params;\n  }\n  if (queryString.indexOf('?') == 0 || queryString.indexOf('#') == 0) {\n    queryString = queryString.substr(1);\n  }\n  const pairs = queryString.split('&');\n  for (let i = 0; i < pairs.length; i++) {\n    const pair = pairs[i];\n    const eqIndex = pair.indexOf('=');\n    let name;\n    let value;\n    if (eqIndex != -1) {\n      name = decodeURIComponent(pair.substring(0, eqIndex)).trim();\n      value = decodeURIComponent(pair.substring(eqIndex + 1)).trim();\n    } else {\n      name = decodeURIComponent(pair).trim();\n      value = '';\n    }\n    if (name) {\n      params[name] = value;\n    }\n  }\n  return params;\n}\n\n\n/**\n * Don't use this directly, only exported for testing. The value\n * is available via the origin property of the object returned by\n * parseUrl.\n * @param {!Location} info\n * @return {string}\n * @visibleForTesting\n */\nexport function getOrigin(info) {\n  if (info.protocol == 'data:' || !info.host) {\n    return info.href;\n  }\n  return info.protocol + '//' + info.host;\n}\n\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assert} from './asserts';\nimport {getService} from './service';\n\n\n/**\n * The \"init\" argument of the Fetch API. Currently, only \"credentials: include\"\n * is implemented.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/fetch\n *\n * @typedef {{\n *   body: (!Object|!Array|undefined),\n *   credentials: (string|undefined),\n *   headers: (!Object|undefined),\n *   method: (string|undefined)\n * }}\n */\nlet FetchInitDef;\n\n/** @private @const {!Array<string>} */\nconst allowedMethods_ = ['GET', 'POST'];\n\n/** @private @const {!Array<string>} */\nconst allowedBodyTypes_ = ['[object Object]', '[object Array]'];\n\n\n/**\n * A service that polyfills Fetch API for use within AMP.\n */\nclass Xhr {\n\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /**\n     * We want to call `fetch_` unbound from any context since it could\n     * be either the native fetch or our polyfill.\n     * @private @const {function(string, ?FetchInitDef=):!Promise<!FetchResponse>}\n     */\n    this.fetch_ = (win.fetch || fetchPolyfill).bind(null);\n  }\n\n  /**\n   * Fetches and constructs JSON object based on the fetch polyfill.\n   *\n   * See https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/fetch\n   *\n   * @param {string} input\n   * @param {?FetchInitDef=} opt_init\n   * @return {!Promise<!JSONValue>}\n   */\n  fetchJson(input, opt_init) {\n    const init = opt_init || {};\n    init.method = normalizeMethod_(init.method);\n    setupJson_(init);\n\n    return this.fetch_(input, init).then(response => {\n      return assertSuccess(response).json();\n    });\n  }\n\n  /**\n   * Sends the request, awaits result and confirms that it was successful.\n   *\n   * See https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/fetch\n   *\n   * @param {string} input\n   * @param {?FetchInitDef=} opt_init\n   * @return {!Promise}\n   */\n  sendSignal(input, opt_init) {\n    return this.fetch_(input, opt_init).then(response => {\n      assertSuccess(response);\n    });\n  }\n}\n\n\n/**\n * Normalized method name by uppercasing.\n * @param {string|undefined} method\n * @return {string}\n * @private\n */\nexport function normalizeMethod_(method) {\n  if (method === undefined) {\n    return 'GET';\n  }\n  return method.toUpperCase();\n}\n\n/**\n* Initialize init object with headers and stringifies the body.\n * @param {!FetchInitDef} init\n * @private\n */\nfunction setupJson_(init) {\n  assert(allowedMethods_.indexOf(init.method) != -1, 'Only one of ' +\n      allowedMethods_.join(', ') + ' is currently allowed. Got %s',\n      init.method);\n\n  init.headers = {\n    'Accept': 'application/json'\n  };\n\n  if (init.method == 'POST') {\n    const bodyType = Object.prototype.toString.call(init.body);\n\n    // Assume JSON strict mode where only objects or arrays are allowed\n    // as body.\n    assert(allowedBodyTypes_.indexOf(bodyType) > -1,\n        'body must be of type object or array. %s',\n        init.body);\n\n    init.headers['Content-Type'] = 'application/json;charset=utf-8';\n    init.body = JSON.stringify(init.body);\n  }\n}\n\n\n/**\n * A minimal polyfill of Fetch API. It only polyfills what we currently use.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/fetch\n *\n * Notice that the \"fetch\" method itself is not exported as that would require\n * us to immediately support a much wide API.\n *\n * @param {string} input\n * @param {!FetchInitDef=} opt_init\n * @return {!Promise<!FetchResponse>}\n * @private Visible for testing\n */\nexport function fetchPolyfill(input, opt_init) {\n  assert(typeof input == 'string', 'Only URL supported: %s', input);\n  const init = opt_init || {};\n  assert(!init.credentials || init.credentials == 'include',\n      'Only credentials=include support: %s', init.credentials);\n\n  return new Promise(function(resolve, reject) {\n    const xhr = createXhrRequest(init.method || 'GET', input, init);\n\n    if (init.credentials == 'include') {\n      xhr.withCredentials = true;\n    }\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState < /* STATUS_RECEIVED */ 2) {\n        return;\n      }\n      if (xhr.status < 100 || xhr.status > 599) {\n        xhr.onreadystatechange = null;\n        reject(new Error(`Unknown HTTP status ${xhr.status}`));\n        return;\n      }\n\n      // TODO(dvoytenko): This is currently simplified: we will wait for the\n      // whole document loading to complete. This is fine for the use cases\n      // we have now, but may need to be reimplemented later.\n      if (xhr.readyState == /* COMPLETE */ 4) {\n        resolve(new FetchResponse(xhr));\n      }\n    };\n    xhr.onerror = () => {\n      reject(new Error('Network failure'));\n    };\n    xhr.onabort = () => {\n      reject(new Error('Request aborted'));\n    };\n\n    if (init.method == 'POST') {\n      xhr.send(init.body);\n    } else {\n      xhr.send();\n    }\n  });\n}\n\n\n/**\n * @param {string} method\n * @param {string} url\n * @param {!FetchInitDef} init\n * @return {!XMLHttpRequest}\n * @private\n */\nfunction createXhrRequest(method, url, init) {\n  let xhr = new XMLHttpRequest();\n  if ('withCredentials' in xhr) {\n    xhr.open(method, url, true);\n  } else if (typeof XDomainRequest != 'undefined') {\n    // IE-specific object.\n    xhr = new XDomainRequest();\n    xhr.open(method, url);\n  } else {\n    throw new Error('CORS is not supported');\n  }\n\n  if (init.headers) {\n    Object.keys(init.headers).forEach(function(header) {\n      xhr.setRequestHeader(header, init.headers[header]);\n    });\n  }\n  return xhr;\n}\n\n\n/**\n * Returns the response if successful or otherwise throws an error.\n * @paran {!FetchResponse} response\n * @return {!FetchResponse}\n */\nfunction assertSuccess(response) {\n  if (response.status < 200 || response.status > 299) {\n    throw new Error(`HTTP error ${response.status}`);\n  }\n  return response;\n}\n\n\n/**\n * Response object in the Fetch API.\n *\n * See https://developer.mozilla.org/en-US/docs/Web/API/GlobalFetch/fetch\n */\nclass FetchResponse {\n  /**\n   * @param {!XMLHttpRequest} xhr\n   */\n  constructor(xhr) {\n    /** @private @const {!XMLHttpRequest} */\n    this.xhr_ = xhr;\n\n    /** @type {number} */\n    this.status = this.xhr_.status;\n\n    /** @type {boolean} */\n    this.bodyUsed = false;\n  }\n\n  /**\n   * Drains the response and returns the text.\n   * @return {!Promise<string>}\n   * @private\n   */\n  drainText_() {\n    assert(!this.bodyUsed, 'Body already used');\n    this.bodyUsed = true;\n    return Promise.resolve(this.xhr_.responseText);\n  }\n\n  /**\n   * Drains the response and returns the JSON object.\n   * @return {!Promise<!JSONValue>}\n   */\n  json() {\n    return this.drainText_().then(JSON.parse);\n  }\n}\n\n\n/**\n * @param {!Window} window\n * @return {!Xhr}\n */\nexport function xhrFor(window) {\n  return getService(window, 'xhr', () => {\n    return new Xhr(window);\n  });\n};\n"]}