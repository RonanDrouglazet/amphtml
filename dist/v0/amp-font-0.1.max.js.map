{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","build/all/v0/amp-font-0.1.max.js","build/all/v0/fontloader.js","src/asserts.js","src/dom.js","src/service.js","src/style.js","src/timer.js","src/vsync.js"],"names":[],"mappings":"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","file":"amp-font-0.1.max.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * @fileoverview Triggers and monitors loading of custom fonts on AMP pages.\n * Example:\n * <code>\n * <amp-font\n *   font-family=\"My Font\"\n *   timeout=\"3s\"\n *   font-weight=\"bold\"\n *   on-error-add-class=\"myfont2-missing\"\n *   on-error-remove-class=\"myfont3-loaded\"\n *   on-load-add-class=\"myfont2-loaded\"\n *   on-load-remove-class=\"myfont1-loaded\"\n *   layout=\"nodisplay\">\n * </amp-font>\n * </code>\n *\n * the amp-font element's layout type is nodisplay.\n */\n\nimport {FontLoader} from './fontloader';\nimport {timer} from '../../../src/timer';\n\n/** @private @const {number} */\nconst DEFAULT_TIMEOUT_ = 3000;\n\n/** @private @const {string} */\nconst DEFAULT_WEIGHT_ = '400';\n\n/** @private @const {string} */\nconst DEFAULT_VARIANT_ = 'normal';\n\n/** @private @const {string} */\nconst DEFAULT_STYLE_ = 'normal';\n\n/** @private @const {string} */\nconst DEFAULT_SIZE_ = 'medium';\n\n/** @private @const {number}*/\n/**\n * https://output.jsbin.com/badore - is js bin experiment to test timeouts on\n * various mobile devices. Loade the page and try refreshing it to serve the\n * font from cache.\n *\n * Font load times (from the browser cache) documented as follows:\n * Wifi\n * iPhone6(iOs 9.1) - safari - 2ms ~ 14ms\n * Windows phone(8.1 Update 2) - IE - 20ms ~ 46ms\n * Nexus5 (Android 6.0.0) - Chrome(44.0.2403.133) - 24ms ~ 52ms\n * Samsung Galaxy S4 (Android 4.4.2) - Default Browser - 7ms - 24ms\n *\n * LTE\n * iPhone6(iOs 9.1) - safari - 6ms ~ 14ms\n * Nexus5 (Android 6.0.0) - Chrome(46.0.2) - 46ms ~ 100ms\n */\nconst CACHED_FONT_LOAD_TIME_ = 100;\n\n\nexport class AmpFont extends AMP.BaseElement {\n\n\n  /** @override */\n  prerenderAllowed() {\n    return true;\n  }\n\n\n  /** @override */\n  buildCallback() {\n    /** @private @const {string} */\n    this.fontFamily_ = AMP.assert(this.element.getAttribute('font-family'),\n        'The font-family attribute is required for <amp-font> %s',\n        this.element);\n    /** @private @const {string} */\n    this.fontWeight_ =\n        this.element.getAttribute('font-weight') || DEFAULT_WEIGHT_;\n    /** @private @const {string} */\n    this.fontStyle_ =\n        this.element.getAttribute('font-style') || DEFAULT_STYLE_;\n    /** @private @const {string} */\n    this.fontVariant_ =\n        this.element.getAttribute('font-variant') || DEFAULT_VARIANT_;\n    /** @private @const {!Document} */\n    this.document_ = this.getWin().document;\n    /** @private @const {!Element} */\n    this.documentElement_ = this.document_.documentElement;\n    /** @private @const {!FontLoader} */\n    this.fontLoader_ = new FontLoader(this.getWin());\n    this.startLoad_();\n  }\n\n\n  /**\n   * Starts to download the font.\n   * @private\n   */\n  startLoad_() {\n    /** @type FontConfig */\n    const fontConfig = {\n      style: this.fontStyle_,\n      variant: this.fontVariant_,\n      weight: this.fontWeight_,\n      size: DEFAULT_SIZE_,\n      family: this.fontFamily_\n    };\n    this.fontLoader_.load(fontConfig, this.getTimeout_()).then(() => {\n      this.onFontLoadSuccess_();\n    }).catch(unusedError => {\n      this.onFontLoadError_();\n      console./* OK */warn(\n          'Font download timed out for ' + this.fontFamily_);\n    });\n  }\n\n\n  /**\n   * @private\n   */\n  onFontLoadSuccess_() {\n    const addClassName = this.element.getAttribute('on-load-add-class');\n    const removeClassName =\n        this.element.getAttribute('on-load-remove-class');\n    this.onFontLoadFinish_(addClassName, removeClassName);\n  }\n\n\n  /**\n   * @private\n   */\n  onFontLoadError_() {\n    const addClassName = this.element.getAttribute('on-error-add-class');\n    const removeClassName =\n        this.element.getAttribute('on-error-remove-class');\n    this.onFontLoadFinish_(addClassName, removeClassName);\n  }\n\n\n  /**\n   * @param {?string} addClassName css class to be added to the\n   *    document-element.\n   * @param {?string} removeClassName css class to be removed from the\n   *    document-element.\n   * @private\n   */\n  onFontLoadFinish_(addClassName, removeClassName) {\n    if (addClassName) {\n      this.documentElement_.classList.add(addClassName);\n    }\n    if (removeClassName) {\n      this.documentElement_.classList.remove(removeClassName);\n      this.document_.body.classList.remove(removeClassName);\n    };\n    this.dispose_();\n  }\n\n\n  /**\n   * @private\n   */\n  dispose_() {\n    this.fontLoader_ = null;\n  }\n\n\n  /**\n   * Computes and returns the time (in ms) to wait for font download.\n   * @returns {number} time (in ms) to wait for font download.\n   * @private\n   */\n  getTimeout_() {\n    let timeoutInMs = parseInt(this.element.getAttribute('timeout'), 10);\n    timeoutInMs = isNaN(timeoutInMs) || timeoutInMs < 0 ?\n        DEFAULT_TIMEOUT_ : timeoutInMs;\n    timeoutInMs = Math.max(\n      (timeoutInMs - timer.timeSinceStart()), CACHED_FONT_LOAD_TIME_);\n    return timeoutInMs;\n  }\n}\n\n\nAMP.registerElement('amp-font', AmpFont);\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/*eslint no-unused-vars: 0*/\n/**\n * @typedef {{\n *  style: string,\n *  variant: string,\n *  weight: string,\n *  size: string,\n *  family: string\n * }}\n */\nlet FontConfigDef;\n\n\n/** @private @const {Array.<string>} */\nconst DEFAULT_FONTS_ = ['sans-serif', 'serif'];\n\n/** @private @const {string} */\nconst TEST_STRING_ = 'MAxmTYklsjo190QW';\n\n/** @private @const {number} */\nconst TOLERANCE_ = 2;\n\n\nimport {removeElement} from '../../../src/dom';\nimport {timer} from '../../../src/timer';\nimport {vsyncFor} from '../../../src/vsync';\nimport * as style from '../../../src/style';\n\n\nexport class FontLoader {\n\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /** @private @const {!Window} */\n    this.win_ = win;\n    /** @private @const {!Document} */\n    this.document_ = win.document;\n    /** @private {?Element} */\n    this.container_ = null;\n    /** @private {?Array.<Element>} */\n    this.defaultFontElements_ = null;\n    /** @private {?Element} */\n    this.customFontElement_ = null;\n    /** @private {boolean} */\n    this.fontLoadResolved_ = false;\n    /** @private {boolean} */\n    this.fontLoadRejected_ = false;\n    /** @private {FontConfigDef} */\n    this.fontConfig_ = null;\n  }\n\n\n  /**\n   * Triggers the font load. Returns promise that will complete when loading\n   * is considered to be complete.\n   * @param {!FontConfigDef} fontConfig Config that describes the font to be\n   *    loaded.\n   * @param {number} timeout number of milliseconds after which the font load\n   *    attempt would be stopped.\n   * @return {!Promise}\n   */\n  load(fontConfig, timeout) {\n    this.fontConfig_ = fontConfig;\n    return timer.timeoutPromise(timeout, this.load_()).then(() => {\n      this.fontLoadResolved_ = true;\n      this.dispose_();\n    }).catch(reason => {\n      this.fontLoadRejected_ = true;\n      this.dispose_();\n      throw reason;\n    });\n  }\n\n\n  /**\n   * Triggers the font load. Returns promise that will complete when loading\n   * is considered to be complete.\n   * @return {!Promise}\n   * @private\n   */\n  load_() {\n    return new Promise((resolve, reject) => {\n      /* style | variant | weight | size/line-height | family */\n      /* font: italic small-caps bolder 16px/3 cursive; */\n      const fontString = (\n        this.fontConfig_.style + ' ' +\n        this.fontConfig_.variant + ' ' +\n        this.fontConfig_.weight + ' ' +\n        this.fontConfig_.size + ' ' +\n        this.fontConfig_.family);\n\n      if (this.canUseNativeApis_()) {\n        // Check if font already exists.\n        if (this.document_.fonts.check(fontString)) {\n          resolve();\n        } else {\n          // Load font with native api if supported.\n          this.document_.fonts.load(fontString).then(() => {\n            if (this.document_.fonts.check(fontString)) {\n              resolve();\n            } else {\n              reject(new Error('Font could not be loaded,'\n                  + ' probably due to incorrect @font-face.'));\n            }\n          }).catch(reject);\n        }\n      } else {\n        // Load font with polyfill if native api is not supported.\n        this.loadWithPolyfill_().then(resolve, reject);\n      }\n    });\n  }\n\n\n  /**\n   * @returns {boolean} True when native font api is supported by the browser.\n   * @private\n   */\n  canUseNativeApis_() {\n    return 'fonts' in this.document_;\n  }\n\n\n  /**\n   * Make the browsers that don't support font loading events to download the\n   * custom font by creating an element (with text) not visible on the viewport.\n   * Font download is detected by comparing the elements height and width with\n   * measurements between default fonts and custom font.\n   * @private\n   */\n  loadWithPolyfill_() {\n    return new Promise((resolve, reject) => {\n      const vsync = vsyncFor(this.win_);\n      // Create DOM elements\n      this.createElements_();\n      // Measure until timeout (or font load).\n      const vsyncTask = vsync.createTask({\n        measure: () => {\n          if (this.fontLoadResolved_) {\n            resolve();\n          } else if (this.fontLoadRejected_) {\n            reject(new Error('Font loading timed out.'));\n          } else if (this.compareMeasurements_()) {\n            resolve();\n          } else {\n            vsyncTask();\n          }\n        }\n      });\n      vsyncTask();\n    });\n  }\n\n\n  /**\n   * Step 1 for loading font on browsers that don't support font loading events.\n   * Creates divs hidden from the viewport and measures dimensions for default\n   * fonts.\n   * @private\n   */\n  createElements_() {\n    const containerElement = this.container_ =\n        this.document_.createElement('div');\n    style.setStyles(containerElement, {\n      // Use larger font-size to better detect font load.\n      fontSize: '40px',\n      fontVariant: this.fontConfig_.variant,\n      left: '-999px',\n      lineHeight: 'normal',\n      margin: 0,\n      padding: 0,\n      position: 'absolute',\n      top: '-999px',\n      visibility: 'hidden'\n    });\n    this.defaultFontElements_ = [];\n    DEFAULT_FONTS_.forEach(font => {\n      const defaultFontElement = this.document_.createElement('div');\n      this.defaultFontElements_.push(defaultFontElement);\n      defaultFontElement.textContent = TEST_STRING_;\n      style.setStyles(defaultFontElement, {\n        fontFamily: font,\n        margin: 0,\n        padding: 0,\n        whiteSpace: 'nowrap'\n      });\n      containerElement.appendChild(defaultFontElement);\n    });\n    // Adding custom font family to the element to trigger load.\n    // The loading will begin after the container has been appended to the body.\n    const customFontElement = this.customFontElement_ =\n        this.document_.createElement('div');\n    style.setStyles(customFontElement, {\n      fontFamily: this.fontConfig_.family,\n      margin: 0,\n      padding: 0,\n      whiteSpace: 'nowrap'\n    });\n    customFontElement.textContent = TEST_STRING_;\n    containerElement.appendChild(customFontElement);\n    this.document_.body.appendChild(containerElement);\n  }\n\n\n  /**\n   * Compare dimensions between elements styled with default fonts and custom\n   * font.\n   * @returns {boolean} Returns true if the dimensions are noticeably different\n   * else returns false.\n   * @private\n   */\n  compareMeasurements_() {\n    return this.defaultFontElements_.some(defaultElement => {\n      const hasWidthChanged = (\n          Math.abs(\n              defaultElement./*OK*/offsetWidth -\n              this.customFontElement_./*OK*/offsetWidth) >\n              TOLERANCE_);\n      const hasHeightChanged = (\n          Math.abs(\n              defaultElement./*OK*/offsetHeight -\n              this.customFontElement_./*OK*/offsetHeight) >\n              TOLERANCE_);\n      return (hasWidthChanged || hasHeightChanged);\n    });\n  }\n\n\n  /**\n   * @private\n   */\n  dispose_() {\n    if (this.container_) {\n      removeElement(this.container_);\n    }\n    this.container_ = null;\n    this.defaultFontElements_ = null;\n    this.customFontElement_ = null;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * Throws an error if the first argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - associatedElement: This is the first element provided in the var args.\n *   It can be used for improved display of error messages.\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n *\n * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n *     not evaluate to true.\n * @param {string} message The assertion message\n * @param {...*} var_args Arguments substituted into %s in the message.\n * @return {T} The value of shouldBeTrueish.\n * @template T\n */\n/*eslint \"google-camelcase/google-camelcase\": 0*/\nexport function assert(shouldBeTrueish, message, var_args) {\n  let firstElement;\n  if (!shouldBeTrueish) {\n    message = message || 'Assertion failed';\n    const splitMessage = message.split('%s');\n    const first = splitMessage.shift();\n    let formatted = first;\n    const messageArray = [];\n    pushIfNonEmpty(messageArray, first);\n    for (let i = 2; i < arguments.length; i++) {\n      const val = arguments[i];\n      if (val && val.tagName) {\n        firstElement = val;\n      }\n      const nextConstant = splitMessage.shift();\n      messageArray.push(val);\n      pushIfNonEmpty(messageArray, nextConstant.trim());\n      formatted += toString(val) + nextConstant;\n    }\n    const e = new Error(formatted);\n    e.fromAssert = true;\n    e.associatedElement = firstElement;\n    e.messageArray = messageArray;\n    throw e;\n  }\n  return shouldBeTrueish;\n}\n/*eslint \"google-camelcase/google-camelcase\": 2*/\n\n/**\n * @param {*} val\n * @return {string}\n */\nfunction toString(val) {\n  if (val instanceof Element) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return val;\n}\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n/**\n * Removes the element.\n * @param {!Element} element\n */\nexport function removeElement(element) {\n  if (element.parentElement) {\n    element.parentElement.removeChild(element);\n  }\n}\n\n\n/**\n * Removes all child nodes of the specified element.\n * @param {!Element} parent\n */\nexport function removeChildren(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n}\n\n\n/**\n * Copies all children nodes of element \"from\" to element \"to\". Child nodes\n * are deeply cloned. Notice, that this method should be used with care and\n * preferably on smaller subtrees.\n * @param {!Element} from\n * @param {!Element} to\n */\nexport function copyChildren(from, to) {\n  const frag = to.ownerDocument.createDocumentFragment();\n  for (let n = from.firstChild; n; n = n.nextSibling) {\n    frag.appendChild(n.cloneNode(true));\n  }\n  to.appendChild(frag);\n}\n\n\n/**\n * Finds the closest element that satisfies the callback from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function closest(element, callback) {\n  for (let el = element; el; el = el.parentElement) {\n    if (callback(el)) {\n      return el;\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the closest element with the specified name from this element\n * up the DOM subtree.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function closestByTag(element, tagName) {\n  tagName = tagName.toUpperCase();\n  return closest(element, el => {\n    return el.tagName == tagName;\n  });\n}\n\n\n/**\n * Finds the first descendant element with the specified name.\n * @param {!Element} element\n * @param {string} tagName\n * @return {?Element}\n */\nexport function elementByTag(element, tagName) {\n  const elements = element.getElementsByTagName(tagName);\n  return elements.length > 0 ? elements[0] : null;\n}\n\n\n/**\n * Finds the first child element that satisfies the callback.\n * @param {!Element} parent\n * @param {function(!Element):boolean} callback\n * @return {?Element}\n */\nexport function childElement(parent, callback) {\n  const children = parent.children;\n  for (let i = 0; i < children.length; i++) {\n    if (callback(children[i])) {\n      return children[i];\n    }\n  }\n  return null;\n}\n\n\n/**\n * Finds the first child element that has the specified attribute, optionally\n * with a value.\n * @param {!Element} parent\n * @param {string} attr\n * @param {string=} opt_value\n * @return {?Element}\n */\nexport function childElementByAttr(parent, attr, opt_value) {\n  return childElement(parent, el => {\n    if (!el.hasAttribute(attr)) {\n      return false;\n    }\n    if (opt_value !== undefined && el.getAttribute(attr) != opt_value) {\n      return false;\n    }\n    return true;\n  });\n}\n\n\n/**\n * Finds the first child element that has the specified tag name.\n * @param {!Element} parent\n * @param {string} tagName\n * @return {?Element}\n */\nexport function childElementByTag(parent, tagName) {\n  tagName = tagName.toUpperCase();\n  return childElement(parent, el => {\n    return el.tagName == tagName;\n  });\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {assert} from './asserts';\n\n/**\n * Holds info about a service.\n * - obj: Actual service implementation when available.\n * - promise: Promise for the obj.\n * - resolve: Function to resolve the promise with the object.\n * @typedef {{\n *   obj: (?Object),\n *   promise: (?Promise|undefined),\n *   resolve: (?function(!Object)|undefined),\n * }}\n */\nlet ServiceHolderDef;\n\n/**\n * Returns a service for the given id and window (a per-window singleton).\n * If the service is not yet available the factory function is invoked and\n * expected to return the service.\n * Users should typically wrap this as a special purpose function (e.g.\n * viewportFor(win)) for type safety and because the factory should not be\n * passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {function(!Window):!Object=} opt_factory Should create the service\n *     if it does not exist yet. If the factory is not given, it is an error\n *     if the service does not exist yet.\n * @return {*}\n */\nexport function getService(win, id, opt_factory) {\n  const services = getServices(win);\n  let s = services[id];\n  if (!s) {\n    s = services[id] = {};\n  }\n  if (!s.obj) {\n    assert(opt_factory, 'Factory not given and service missing %s', id);\n    s.obj = opt_factory(win);\n    // The service may have been requested already, in which case we have a\n    // pending promise we need to fulfill.\n    if (s.resolve) {\n      s.resolve(s.obj);\n    }\n  }\n  return s.obj;\n}\n\n/**\n * Returns a promise for a service for the given id and window. Also expects\n * an element that has the actual implementation. The promise resolves when\n * the implementation loaded.\n * Users should typically wrap this as a special purpose function (e.g.\n * viewportFor(win)) for type safety and because the factory should not be\n * passed around.\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} provideByElement Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<*>}\n */\nexport function getElementService(win, id, providedByElement) {\n  // Call `getElementService_` in a micro-task to ensure that `stubElements`\n  // has been called.\n  return Promise.resolve().then(() => {\n    return getElementService_(win, id, providedByElement);\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {string} id of the service.\n * @param {string} provideByElement Name of the custom element that provides\n *     the implementation of this service.\n * @return {!Promise<*>}\n * @private\n */\nfunction getElementService_(win, id, providedByElement) {\n  assert(isElementScheduled(win, providedByElement),\n      'Service %s was requested to be provided through %s, ' +\n      'but %s is not loaded in the current page. To fix this ' +\n      'problem load the JavaScript file for %s in this page.',\n      id, providedByElement, providedByElement, providedByElement);\n  const services = getServices(win);\n  const s = services[id];\n  if (s) {\n    // If a service was registered with getService, we make a promise from it\n    // which we will return in future invocations.\n    if (!s.promise) {\n      s.promise = Promise.resolve(s.obj);\n    }\n    return s.promise;\n  }\n  // TODO(@cramforce): Add a check that if the element is eventually registered\n  // that the service is actually provided and this promise resolves.\n  let resolve;\n  const p = new Promise(r => {\n    resolve = r;\n  });\n  services[id] = {\n    obj: null,\n    promise: p,\n    resolve: resolve,\n  };\n\n  return p;\n}\n\n/**\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n * @return {boolean} Whether this element is scheduled to be loaded.\n */\nfunction isElementScheduled(win, elementName) {\n  assert(win.ampExtendedElements, 'win.ampExtendedElements not created yet');\n  return !!win.ampExtendedElements[elementName];\n}\n\n/**\n * In order to provide better error messages we only allow to retrieve\n * services from other elements if those elements are loaded in the page.\n * This makes it possible to mark an element as loaded in a test.\n * @param {!Window} win\n * @param {string} elementName Name of an extended custom element.\n */\nexport function markElementScheduledForTesting(win, elementName) {\n  if (!win.ampExtendedElements) {\n    win.ampExtendedElements = {};\n  }\n  win.ampExtendedElements[elementName] = true;\n}\n\n/**\n * Returns the object that holds the services registered in a window.\n * @param {!Window} win\n * @return {!Object<string,!ServiceHolderDef>}\n */\nfunction getServices(win) {\n  let services = win.services;\n  if (!services) {\n    services = win.services = {};\n  }\n  return services;\n}\n\n/**\n * Resets a single service, so it gets recreated on next getService invocation.\n * @param {!Window} win\n * @param {string} id of the service.\n */\nexport function resetServiceForTesting(win, id) {\n  if (win.services) {\n    win.services[id] = null;\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\n\n/** @private @const {!Object<string>} */\nconst propertyNameCache_ = Object.create(null);\n\n/** @private @const {!Array<string>} */\nconst vendorPrefixes_ = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\n\n/**\n * @export\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n * Checks the object if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} object\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(object, titleCase) {\n  for (let i = 0; i < vendorPrefixes_.length; i++) {\n    const propertyName = vendorPrefixes_[i] + titleCase;\n    if (object[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @export\n * @param {!Object} object\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(object, camelCase, opt_bypassCache) {\n  let propertyName = propertyNameCache_[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (object[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(object, titleCase);\n\n      if (object[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache_[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {!Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (propertyName) {\n    element.style[propertyName] = opt_units ? value + opt_units : value;\n  }\n}\n\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(element.style, property,\n      opt_bypassCache);\n  if (!propertyName) {\n    return undefined;\n  }\n  return element.style[propertyName];\n}\n\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = !(element.style.display != 'none');\n  }\n  element.style.display = opt_display ? '' : 'none';\n}\n\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return value + 'px';\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x},${opt_y})`;\n}\n\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Helper with all things Timer.\n */\nexport class Timer {\n\n  /**\n   * @param {!Window} win\n   */\n  constructor(win) {\n    /** @const {!Window} */\n    this.win = win;\n\n    /** @private @const {!Promise}  */\n    this.resolved_ = Promise.resolve();\n\n    this.taskCount_ = 0;\n\n    this.canceled_ = {};\n\n    /** @const {number} */\n    this.startTime_ = this.now();\n  }\n\n  /**\n   * Returns the current EPOC time in milliseconds.\n   * @return {number}\n   */\n  now() {\n    // TODO(dvoytenko): when can we use Date.now?\n    return Number(new Date());\n  }\n\n /**\n  * Returns time since start in milliseconds.\n  * @return {number}\n  */\n  timeSinceStart() {\n    return this.now() - this.startTime_;\n  }\n\n  /**\n   * Runs the provided callback after the specified delay. This uses a micro\n   * task for 0 or no specified time. This means that the delay will actually\n   * be close to 0 and this will NOT yield to the event queue.\n   *\n   * Returns the timer ID that can be used to cancel the timer (cancel method).\n   * @param {!function()} callback\n   * @param {number=} opt_delay\n   * @return {number|string}\n   */\n  delay(callback, opt_delay) {\n    if (!opt_delay) {\n      // For a delay of zero,  schedule a promise based micro task since\n      // they are predictably fast.\n      const id = 'p' + this.taskCount_++;\n      this.resolved_.then(() => {\n        if (this.canceled_[id]) {\n          delete this.canceled_[id];\n          return;\n        }\n        callback();\n      });\n      return id;\n    }\n    return this.win.setTimeout(callback, opt_delay);\n  }\n\n  /**\n   * Cancels the previously scheduled callback.\n   * @param {number|string} timeoutId\n   */\n  cancel(timeoutId) {\n    if (typeof timeoutId == 'string') {\n      this.canceled_[timeoutId] = true;\n      return;\n    }\n    this.win.clearTimeout(timeoutId);\n  }\n\n  /**\n   * Returns a promise that will resolve after the delay. Optionally, the\n   * resolved value can be provided as opt_result argument.\n   * @param {number=} opt_delay\n   * @param {RESULT=} opt_result\n   * @return {!Promise<RESULT>}\n   * @template RESULT\n   */\n  promise(opt_delay, opt_result) {\n    let timerKey = null;\n    return new Promise((resolve, reject) => {\n      timerKey = this.delay(() => {\n        timerKey = -1;\n        resolve(opt_result);\n      }, opt_delay);\n      if (timerKey == -1) {\n        reject(new Error('Failed to schedule timer.'));\n      }\n    }).catch(error => {\n      // Clear the timer. The most likely reason is \"cancel\" signal.\n      if (timerKey != -1) {\n        this.cancel(timerKey);\n      }\n      return Promise.reject(error);\n    });\n  }\n\n  /**\n   * Returns a promise that will fail after the specified delay. Optionally,\n   * this method can take opt_racePromise parameter. In this case, the\n   * resulting promise will either fail when the specified delay expires or\n   * will resolve based on the opt_racePromise, whichever happens first.\n   * @param {number} delay\n   * @param {!Promise<RESULT>|undefined} opt_racePromise\n   * @return {!Promise<RESULT>}\n   * @template RESULT\n   */\n  timeoutPromise(delay, opt_racePromise) {\n    let timerKey = null;\n    const delayPromise = new Promise((_resolve, reject) => {\n      timerKey = this.delay(() => {\n        timerKey = -1;\n        reject('timeout');\n      }, delay);\n      if (timerKey == -1) {\n        reject(new Error('Failed to schedule timer.'));\n      }\n    }).catch(error => {\n      // Clear the timer. The most likely reason is \"cancel\" signal.\n      if (timerKey != -1) {\n        this.cancel(timerKey);\n      }\n      return Promise.reject(error);\n    });\n    if (!opt_racePromise) {\n      return delayPromise;\n    }\n    // Avoids Promise->race due to presubmit check against it.\n    return new Promise((resolve, reject) => {\n      delayPromise.then(resolve, reject);\n      opt_racePromise.then(resolve, reject);\n    });\n  }\n}\n\n\nexport const timer = new Timer(window);\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getService} from './service';\n\n\n/**\n * @param {!Window} window\n * @return {!Vsync}\n */\nexport function vsyncFor(window) {\n  return getService(window, 'vsync');\n};\n"]}